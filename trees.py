import numpy as np
import matplotlib.pyplot as plt

def tree(base,graph,cycle):
	#find parents
	parents = graph[base][0]
	for each in cycle:
		if each in parents:
			parents.remove(each)


	#add parents to visits
	for a in parents:
		visits.append(a)

	#add co-ordinates to graph array
	n = len(parents)
	count = 0
	amp = graph[base][2][0]
	min_ang = graph[base][2][1]
	max_ang = graph[base][2][2] 

	for b in parents:
		graph[b][2][0] = amp + 1
		graph[b][2][1] = min_ang + count*(max_ang-min_ang)/n
		graph[b][2][2] = min_ang + (count+1)*(max_ang-min_ang)/n 
		count = count + 1

	#draw
	for c in parents:
			mid = (graph[c][2][1] + graph[c][2][2])/2
			xco = graph[c][2][0]*np.cos(np.radians(mid))
			yco = graph[c][2][0]*np.sin(np.radians(mid))
			graph[c][2][3] = xco 
			graph[c][2][4] = yco
			ax.plot(xco,yco,'o',markersize=4)
			ax.arrow(xco, yco, graph[base][2][3]-xco, graph[base][2][4]-yco, head_width=0.01, head_length=0.01, fc='k', ec='k')


	for z in parents:
		tree(z,graph,parents)

#graph[n] gives the parent nodes, child nodes and co-ordinates for the nth node.
#graph[n][2][0] gives polar amplitude, [1] is min angle, [2] is max angle, [3] is x, [4] is y
graph = [[[],[],[0,0,0,0,0]] for x in range(1024)]

targets = [192.0, 640.0, 320.0, 768.0, 160.0, 672.0, 256.0, 768.0, 64.0, 0.0, 320.0, 256.0, 0.0, 0.0, 256.0, 256.0, 128.0, 640.0, 256.0, 768.0, 160.0, 672.0, 256.0, 768.0, 0.0, 0.0, 256.0, 256.0, 0.0, 0.0, 256.0, 256.0, 193.0, 641.0, 321.0, 769.0, 161.0, 673.0, 257.0, 769.0, 65.0, 1.0, 321.0, 257.0, 1.0, 1.0, 257.0, 257.0, 129.0, 641.0, 257.0, 769.0, 161.0, 673.0, 257.0, 769.0, 1.0, 1.0, 257.0, 257.0, 1.0, 1.0, 257.0, 257.0, 194.0, 642.0, 322.0, 770.0, 162.0, 674.0, 258.0, 770.0, 66.0, 2.0, 322.0, 258.0, 2.0, 2.0, 258.0, 258.0, 130.0, 642.0, 258.0, 770.0, 162.0, 674.0, 258.0, 770.0, 2.0, 2.0, 258.0, 258.0, 2.0, 2.0, 258.0, 258.0, 195.0, 643.0, 323.0, 771.0, 163.0, 675.0, 259.0, 771.0, 67.0, 3.0, 323.0, 259.0, 3.0, 3.0, 259.0, 259.0, 131.0, 643.0, 259.0, 771.0, 163.0, 675.0, 259.0, 771.0, 3.0, 3.0, 259.0, 259.0, 3.0, 3.0, 259.0, 259.0, 196.0, 644.0, 324.0, 772.0, 164.0, 676.0, 260.0, 772.0, 68.0, 4.0, 324.0, 260.0, 4.0, 4.0, 260.0, 260.0, 132.0, 644.0, 260.0, 772.0, 164.0, 676.0, 260.0, 772.0, 4.0, 4.0, 260.0, 260.0, 4.0, 4.0, 260.0, 260.0, 197.0, 645.0, 325.0, 773.0, 165.0, 677.0, 261.0, 773.0, 69.0, 5.0, 325.0, 261.0, 5.0, 5.0, 261.0, 261.0, 133.0, 645.0, 261.0, 773.0, 165.0, 677.0, 261.0, 773.0, 5.0, 5.0, 261.0, 261.0, 5.0, 5.0, 261.0, 261.0, 198.0, 646.0, 326.0, 774.0, 166.0, 678.0, 262.0, 774.0, 70.0, 6.0, 326.0, 262.0, 6.0, 6.0, 262.0, 262.0, 134.0, 646.0, 262.0, 774.0, 166.0, 678.0, 262.0, 774.0, 6.0, 6.0, 262.0, 262.0, 6.0, 6.0, 262.0, 262.0, 199.0, 647.0, 327.0, 775.0, 167.0, 679.0, 263.0, 775.0, 71.0, 7.0, 327.0, 263.0, 7.0, 7.0, 263.0, 263.0, 135.0, 647.0, 263.0, 775.0, 167.0, 679.0, 263.0, 775.0, 7.0, 7.0, 263.0, 263.0, 7.0, 7.0, 263.0, 263.0, 200.0, 648.0, 328.0, 776.0, 168.0, 680.0, 264.0, 776.0, 72.0, 8.0, 328.0, 264.0, 8.0, 8.0, 264.0, 264.0, 136.0, 648.0, 264.0, 776.0, 168.0, 680.0, 264.0, 776.0, 8.0, 8.0, 264.0, 264.0, 8.0, 8.0, 264.0, 264.0, 201.0, 649.0, 329.0, 777.0, 169.0, 681.0, 265.0, 777.0, 73.0, 9.0, 329.0, 265.0, 9.0, 9.0, 265.0, 265.0, 137.0, 649.0, 265.0, 777.0, 169.0, 681.0, 265.0, 777.0, 9.0, 9.0, 265.0, 265.0, 9.0, 9.0, 265.0, 265.0, 202.0, 650.0, 330.0, 778.0, 170.0, 682.0, 266.0, 778.0, 74.0, 10.0, 330.0, 266.0, 10.0, 10.0, 266.0, 266.0, 138.0, 650.0, 266.0, 778.0, 170.0, 682.0, 266.0, 778.0, 10.0, 10.0, 266.0, 266.0, 10.0, 10.0, 266.0, 266.0, 203.0, 651.0, 331.0, 779.0, 171.0, 683.0, 267.0, 779.0, 75.0, 11.0, 331.0, 267.0, 11.0, 11.0, 267.0, 267.0, 139.0, 651.0, 267.0, 779.0, 171.0, 683.0, 267.0, 779.0, 11.0, 11.0, 267.0, 267.0, 11.0, 11.0, 267.0, 267.0, 204.0, 652.0, 332.0, 780.0, 172.0, 684.0, 268.0, 780.0, 76.0, 12.0, 332.0, 268.0, 12.0, 12.0, 268.0, 268.0, 140.0, 652.0, 268.0, 780.0, 172.0, 684.0, 268.0, 780.0, 12.0, 12.0, 268.0, 268.0, 12.0, 12.0, 268.0, 268.0, 205.0, 653.0, 333.0, 781.0, 173.0, 685.0, 269.0, 781.0, 77.0, 13.0, 333.0, 269.0, 13.0, 13.0, 269.0, 269.0, 141.0, 653.0, 269.0, 781.0, 173.0, 685.0, 269.0, 781.0, 13.0, 13.0, 269.0, 269.0, 13.0, 13.0, 269.0, 269.0, 206.0, 654.0, 334.0, 782.0, 174.0, 686.0, 270.0, 782.0, 78.0, 14.0, 334.0, 270.0, 14.0, 14.0, 270.0, 270.0, 142.0, 654.0, 270.0, 782.0, 174.0, 686.0, 270.0, 782.0, 14.0, 14.0, 270.0, 270.0, 14.0, 14.0, 270.0, 270.0, 207.0, 655.0, 335.0, 783.0, 175.0, 687.0, 271.0, 783.0, 79.0, 15.0, 335.0, 271.0, 15.0, 15.0, 271.0, 271.0, 143.0, 655.0, 271.0, 783.0, 175.0, 687.0, 271.0, 783.0, 15.0, 15.0, 271.0, 271.0, 15.0, 15.0, 271.0, 271.0, 208.0, 656.0, 336.0, 784.0, 176.0, 688.0, 272.0, 784.0, 80.0, 16.0, 336.0, 272.0, 16.0, 16.0, 272.0, 272.0, 144.0, 656.0, 272.0, 784.0, 176.0, 688.0, 272.0, 784.0, 16.0, 16.0, 272.0, 272.0, 16.0, 16.0, 272.0, 272.0, 209.0, 657.0, 337.0, 785.0, 177.0, 689.0, 273.0, 785.0, 81.0, 17.0, 337.0, 273.0, 17.0, 17.0, 273.0, 273.0, 145.0, 657.0, 273.0, 785.0, 177.0, 689.0, 273.0, 785.0, 17.0, 17.0, 273.0, 273.0, 17.0, 17.0, 273.0, 273.0, 210.0, 658.0, 338.0, 786.0, 178.0, 690.0, 274.0, 786.0, 82.0, 18.0, 338.0, 274.0, 18.0, 18.0, 274.0, 274.0, 146.0, 658.0, 274.0, 786.0, 178.0, 690.0, 274.0, 786.0, 18.0, 18.0, 274.0, 274.0, 18.0, 18.0, 274.0, 274.0, 211.0, 659.0, 339.0, 787.0, 179.0, 691.0, 275.0, 787.0, 83.0, 19.0, 339.0, 275.0, 19.0, 19.0, 275.0, 275.0, 147.0, 659.0, 275.0, 787.0, 179.0, 691.0, 275.0, 787.0, 19.0, 19.0, 275.0, 275.0, 19.0, 19.0, 275.0, 275.0, 212.0, 660.0, 340.0, 788.0, 180.0, 692.0, 276.0, 788.0, 84.0, 20.0, 340.0, 276.0, 20.0, 20.0, 276.0, 276.0, 148.0, 660.0, 276.0, 788.0, 180.0, 692.0, 276.0, 788.0, 20.0, 20.0, 276.0, 276.0, 20.0, 20.0, 276.0, 276.0, 213.0, 661.0, 341.0, 789.0, 181.0, 693.0, 277.0, 789.0, 85.0, 21.0, 341.0, 277.0, 21.0, 21.0, 277.0, 277.0, 149.0, 661.0, 277.0, 789.0, 181.0, 693.0, 277.0, 789.0, 21.0, 21.0, 277.0, 277.0, 21.0, 21.0, 277.0, 277.0, 214.0, 662.0, 342.0, 790.0, 182.0, 694.0, 278.0, 790.0, 86.0, 22.0, 342.0, 278.0, 22.0, 22.0, 278.0, 278.0, 150.0, 662.0, 278.0, 790.0, 182.0, 694.0, 278.0, 790.0, 22.0, 22.0, 278.0, 278.0, 22.0, 22.0, 278.0, 278.0, 215.0, 663.0, 343.0, 791.0, 183.0, 695.0, 279.0, 791.0, 87.0, 23.0, 343.0, 279.0, 23.0, 23.0, 279.0, 279.0, 151.0, 663.0, 279.0, 791.0, 183.0, 695.0, 279.0, 791.0, 23.0, 23.0, 279.0, 279.0, 23.0, 23.0, 279.0, 279.0, 216.0, 664.0, 344.0, 792.0, 184.0, 696.0, 280.0, 792.0, 88.0, 24.0, 344.0, 280.0, 24.0, 24.0, 280.0, 280.0, 152.0, 664.0, 280.0, 792.0, 184.0, 696.0, 280.0, 792.0, 24.0, 24.0, 280.0, 280.0, 24.0, 24.0, 280.0, 280.0, 217.0, 665.0, 345.0, 793.0, 185.0, 697.0, 281.0, 793.0, 89.0, 25.0, 345.0, 281.0, 25.0, 25.0, 281.0, 281.0, 153.0, 665.0, 281.0, 793.0, 185.0, 697.0, 281.0, 793.0, 25.0, 25.0, 281.0, 281.0, 25.0, 25.0, 281.0, 281.0, 218.0, 666.0, 346.0, 794.0, 186.0, 698.0, 282.0, 794.0, 90.0, 26.0, 346.0, 282.0, 26.0, 26.0, 282.0, 282.0, 154.0, 666.0, 282.0, 794.0, 186.0, 698.0, 282.0, 794.0, 26.0, 26.0, 282.0, 282.0, 26.0, 26.0, 282.0, 282.0, 219.0, 667.0, 347.0, 795.0, 187.0, 699.0, 283.0, 795.0, 91.0, 27.0, 347.0, 283.0, 27.0, 27.0, 283.0, 283.0, 155.0, 667.0, 283.0, 795.0, 187.0, 699.0, 283.0, 795.0, 27.0, 27.0, 283.0, 283.0, 27.0, 27.0, 283.0, 283.0, 220.0, 668.0, 348.0, 796.0, 188.0, 700.0, 284.0, 796.0, 92.0, 28.0, 348.0, 284.0, 28.0, 28.0, 284.0, 284.0, 156.0, 668.0, 284.0, 796.0, 188.0, 700.0, 284.0, 796.0, 28.0, 28.0, 284.0, 284.0, 28.0, 28.0, 284.0, 284.0, 221.0, 669.0, 349.0, 797.0, 189.0, 701.0, 285.0, 797.0, 93.0, 29.0, 349.0, 285.0, 29.0, 29.0, 285.0, 285.0, 157.0, 669.0, 285.0, 797.0, 189.0, 701.0, 285.0, 797.0, 29.0, 29.0, 285.0, 285.0, 29.0, 29.0, 285.0, 285.0, 222.0, 670.0, 350.0, 798.0, 190.0, 702.0, 286.0, 798.0, 94.0, 30.0, 350.0, 286.0, 30.0, 30.0, 286.0, 286.0, 158.0, 670.0, 286.0, 798.0, 190.0, 702.0, 286.0, 798.0, 30.0, 30.0, 286.0, 286.0, 30.0, 30.0, 286.0, 286.0, 223.0, 671.0, 351.0, 799.0, 191.0, 703.0, 287.0, 799.0, 95.0, 31.0, 351.0, 287.0, 31.0, 31.0, 287.0, 287.0, 159.0, 671.0, 287.0, 799.0, 191.0, 703.0, 287.0, 799.0, 31.0, 31.0, 287.0, 287.0, 31.0, 31.0, 287.0, 287.0]

targets = [int(z) for z in targets]

for i in range(1024):
	graph[i][1] = targets[i]			#add child
	graph[targets[i]][0].append(i)		#add parent

visits = []

while len(visits)<1024:

	#find where to start
	for i in range(1024):
		if not i in visits:
			break

	#find base nodes
	while not (i in visits):
		visits.append(i)
		i = graph[i][1]

	plt.figure()

	base = visits[visits.index(i):]

	#find co-ordinates of base nodes

	n = len(base)
	count = 0

	for x in base:
		graph[x][2][0] = 1
		graph[x][2][1] = count*180/n
		graph[x][2][2] = (count+1)*180/n 
		count = count + 1

	#draw
	ax = plt.axes()
	plt.axis([-15,15,-15,15])
	plt.title(base)
	circle = plt.Circle((0,0),1, color='k', fill=False)
	ax.add_artist(circle)
	for x in base:
		mid = (graph[x][2][1] + graph[x][2][2])/2.
		graph[x][2][3] = graph[x][2][0]*np.cos(np.radians(mid))
		graph[x][2][4] = graph[x][2][0]*np.sin(np.radians(mid))
		ax.plot(graph[x][2][3], graph[x][2][4],'o')


	for x in base:
		tree(x,graph,base)

	#do it again for the next set

plt.show()
